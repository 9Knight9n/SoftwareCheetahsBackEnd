--
-- Create model Account
--
CREATE TABLE `account_account` (`user_id` integer AUTO_INCREMENT NOT NULL PRIMARY KEY, `first_name` varchar(20) NOT NULL, `last_name` varchar(40) NOT NULL, `email` varchar(60) NOT NULL UNIQUE, `phone_number` varchar(13) NOT NULL UNIQUE, `password` varchar(20) NOT NULL, `role` varchar(20) NOT NULL, `currency` double precision NOT NULL, `national_code` varchar(10) NULL UNIQUE, `gender` varchar(10) NULL, `birthday` date NULL, `image` varchar(100) NULL, `bio` longtext NULL, `date_joined` datetime(6) NOT NULL, `last_login` datetime(6) NOT NULL, `is_admin` bool NOT NULL, `is_active` bool NOT NULL, `is_staff` bool NOT NULL, `is_superuser` bool NOT NULL);

--
-- Create model VerificationCode
--
CREATE TABLE `account_verificationcode` (`id` integer AUTO_INCREMENT NOT NULL PRIMARY KEY, `email` varchar(60) NOT NULL UNIQUE, `vc_code` varchar(6) NOT NULL, `time_generated` datetime(6) NOT NULL);

--
-- Create model Document
--
CREATE TABLE `account_document` (`document_id` integer AUTO_INCREMENT NOT NULL PRIMARY KEY, `file` varchar(100) NOT NULL, `user_id` integer NOT NULL);
ALTER TABLE `account_document` ADD CONSTRAINT `account_document_user_id_fca2a8b6_fk_account_account_user_id` FOREIGN KEY (`user_id`) REFERENCES `account_account` (`user_id`);

--
-- Create model Chat
--
CREATE TABLE `chat_chat` (`chat_id` integer AUTO_INCREMENT NOT NULL PRIMARY KEY, `account1_id` integer NULL, `account2_id` integer NULL);

--
-- Create model Message
--
CREATE TABLE `chat_message` (`message_id` integer AUTO_INCREMENT NOT NULL PRIMARY KEY, `image` varchar(100) NULL, `file` varchar(100) NULL, `text` varchar(1000) NULL, `time` datetime(6) NOT NULL, `chat_id` integer NOT NULL, `owner_id` integer NULL, `parent_message_id` integer NULL);
ALTER TABLE `chat_chat` ADD CONSTRAINT `chat_chat_account1_id_4ac132ad_fk_account_account_user_id` FOREIGN KEY (`account1_id`) REFERENCES `account_account` (`user_id`);
ALTER TABLE `chat_chat` ADD CONSTRAINT `chat_chat_account2_id_65f7e782_fk_account_account_user_id` FOREIGN KEY (`account2_id`) REFERENCES `account_account` (`user_id`);
ALTER TABLE `chat_message` ADD CONSTRAINT `chat_message_chat_id_21483fa7_fk_chat_chat_chat_id` FOREIGN KEY (`chat_id`) REFERENCES `chat_chat` (`chat_id`);
ALTER TABLE `chat_message` ADD CONSTRAINT `chat_message_owner_id_20a4d94c_fk_account_account_user_id` FOREIGN KEY (`owner_id`) REFERENCES `account_account` (`user_id`);
ALTER TABLE `chat_message` ADD CONSTRAINT `chat_message_parent_message_id_d802c014_fk_chat_mess` FOREIGN KEY (`parent_message_id`) REFERENCES `chat_message` (`message_id`);
CREATE INDEX `chat_message_time_1abf5a5d` ON `chat_message` (`time`);

--
-- Create model Detail
--
CREATE TABLE `villa_detail` (`type` varchar(10) NOT NULL, `Detail_id` integer AUTO_INCREMENT NOT NULL PRIMARY KEY, `text` varchar(1000) NOT NULL UNIQUE);
--
-- Create model Document
--
CREATE TABLE `villa_document` (`document_id` integer AUTO_INCREMENT NOT NULL PRIMARY KEY, `file` varchar(100) NOT NULL);
--
-- Create model Image
--
CREATE TABLE `villa_image` (`image_id` integer AUTO_INCREMENT NOT NULL PRIMARY KEY, `title` varchar(40) NULL, `image` varchar(100) NOT NULL, `default` bool NOT NULL);
--
-- Create model Villa
--
CREATE TABLE `villa_villa` (`villa_id` integer AUTO_INCREMENT NOT NULL PRIMARY KEY, `name` varchar(40) NOT NULL, `type` varchar(12) NOT NULL, `description` longtext NULL, `price_per_night` integer NOT NULL, `country` varchar(100) NOT NULL, `state` varchar(100) NOT NULL, `city` varchar(100) NOT NULL, `address` longtext NOT NULL, `postal_code` varchar(10) NOT NULL UNIQUE, `latitude` double precision NOT NULL, `longitude` double precision NOT NULL, `area` integer NOT NULL, `capacity` integer NOT NULL, `max_capacity` integer NOT NULL, `number_of_bathrooms` integer NOT NULL, `number_of_bedrooms` integer NOT NULL, `number_of_single_beds` integer NOT NULL, `number_of_double_beds` integer NOT NULL, `number_of_showers` integer NOT NULL, `visible` bool NOT NULL, `rate` double precision NULL, `no_rate` integer NOT NULL, `owner_id` integer NOT NULL);
CREATE TABLE `villa_villa_details` (`id` integer AUTO_INCREMENT NOT NULL PRIMARY KEY, `villa_id` integer NOT NULL, `detail_id` integer NOT NULL);
CREATE TABLE `villa_villa_documents` (`id` integer AUTO_INCREMENT NOT NULL PRIMARY KEY, `villa_id` integer NOT NULL, `document_id` integer NOT NULL);
CREATE TABLE `villa_villa_images` (`id` integer AUTO_INCREMENT NOT NULL PRIMARY KEY, `villa_id` integer NOT NULL, `image_id` integer NOT NULL);
CREATE TABLE `villa_villa_likes` (`id` integer AUTO_INCREMENT NOT NULL PRIMARY KEY, `villa_id` integer NOT NULL, `account_id` integer NOT NULL);
--
-- Create model Calendar
--
CREATE TABLE `villa_calendar` (`calendar_id` integer AUTO_INCREMENT NOT NULL PRIMARY KEY, `start_date` date NOT NULL, `end_date` date NOT NULL, `num_of_passengers` integer NOT NULL, `total_cost` double precision NOT NULL, `closed` bool NOT NULL, `rate` integer NULL, `customer_id` integer NOT NULL, `villa_id` integer NOT NULL);
ALTER TABLE `villa_villa` ADD CONSTRAINT `villa_villa_owner_id_37d3e746_fk_account_account_user_id` FOREIGN KEY (`owner_id`) REFERENCES `account_account` (`user_id`);
ALTER TABLE `villa_villa_details` ADD CONSTRAINT `villa_villa_details_villa_id_detail_id_64565f7b_uniq` UNIQUE (`villa_id`, `detail_id`);
ALTER TABLE `villa_villa_details` ADD CONSTRAINT `villa_villa_details_villa_id_29e8243b_fk_villa_villa_villa_id` FOREIGN KEY (`villa_id`) REFERENCES `villa_villa` (`villa_id`);
ALTER TABLE `villa_villa_details` ADD CONSTRAINT `villa_villa_details_detail_id_bd735f3f_fk_villa_detail_Detail_id` FOREIGN KEY (`detail_id`) REFERENCES `villa_detail` (`Detail_id`);
ALTER TABLE `villa_villa_documents` ADD CONSTRAINT `villa_villa_documents_villa_id_document_id_cb3c8955_uniq` UNIQUE (`villa_id`, `document_id`);
ALTER TABLE `villa_villa_documents` ADD CONSTRAINT `villa_villa_documents_villa_id_d5e8842e_fk_villa_villa_villa_id` FOREIGN KEY (`villa_id`) REFERENCES `villa_villa` (`villa_id`);
ALTER TABLE `villa_villa_documents` ADD CONSTRAINT `villa_villa_document_document_id_74bfb0d2_fk_villa_doc` FOREIGN KEY (`document_id`) REFERENCES `villa_document` (`document_id`);
ALTER TABLE `villa_villa_images` ADD CONSTRAINT `villa_villa_images_villa_id_image_id_d5685dbf_uniq` UNIQUE (`villa_id`, `image_id`);
ALTER TABLE `villa_villa_images` ADD CONSTRAINT `villa_villa_images_villa_id_03653eb9_fk_villa_villa_villa_id` FOREIGN KEY (`villa_id`) REFERENCES `villa_villa` (`villa_id`);
ALTER TABLE `villa_villa_images` ADD CONSTRAINT `villa_villa_images_image_id_d2b52aec_fk_villa_image_image_id` FOREIGN KEY (`image_id`) REFERENCES `villa_image` (`image_id`);
ALTER TABLE `villa_villa_likes` ADD CONSTRAINT `villa_villa_likes_villa_id_account_id_6223b4ed_uniq` UNIQUE (`villa_id`, `account_id`);
ALTER TABLE `villa_villa_likes` ADD CONSTRAINT `villa_villa_likes_villa_id_5aa1f9bf_fk_villa_villa_villa_id` FOREIGN KEY (`villa_id`) REFERENCES `villa_villa` (`villa_id`);
ALTER TABLE `villa_villa_likes` ADD CONSTRAINT `villa_villa_likes_account_id_b3b1f791_fk_account_account_user_id` FOREIGN KEY (`account_id`) REFERENCES `account_account` (`user_id`);
ALTER TABLE `villa_calendar` ADD CONSTRAINT `villa_calendar_customer_id_e28cb503_fk_account_account_user_id` FOREIGN KEY (`customer_id`) REFERENCES `account_account` (`user_id`);
ALTER TABLE `villa_calendar` ADD CONSTRAINT `villa_calendar_villa_id_6ed84353_fk_villa_villa_villa_id` FOREIGN KEY (`villa_id`) REFERENCES `villa_villa` (`villa_id`);